dojo.provide("dojox.layout.FloatingPane");dojo.experimental("dojox.layout.FloatingPane");dojo.require("dojo.window");dojo.require("dijit._Templated");dojo.require("dijit._Widget");dojo.require("dojo.dnd.Moveable");dojo.require("dojox.layout.ContentPane");dojo.require("dojox.layout.ResizeHandle");dojo.declare("dojox.layout.FloatingPane",[dojox.layout.ContentPane,dijit._Templated],{closable:true,dockable:true,resizable:false,maxable:false,resizeAxis:"xy",title:"",dockTo:"",duration:200,contentClass:"dojoxFloatingPaneContent",_showAnim:null,_hideAnim:null,_dockNode:null,_restoreState:{},_allFPs:[],_startZ:100,templateString:dojo.cache("dojox.layout","resources/FloatingPane.html"),attributeMap:dojo.delegate(dijit._Widget.prototype.attributeMap,{title:{type:"innerHTML",node:"titleNode"}}),postCreate:function(){this.inherited(arguments);new dojo.dnd.Moveable(this.domNode,{handle:this.focusNode});if(!this.dockable){this.dockNode.style.display="none";}if(!this.closable){this.closeNode.style.display="none";}if(!this.maxable){this.maxNode.style.display="none";this.restoreNode.style.display="none";}if(!this.resizable){this.resizeHandle.style.display="none";}else{this.domNode.style.width=dojo.marginBox(this.domNode).w+"px";}this._allFPs.push(this);this.domNode.style.position="absolute";this.bgIframe=new dijit.BackgroundIframe(this.domNode);this._naturalState=dojo.coords(this.domNode);},startup:function(){if(this._started){return;}this.inherited(arguments);if(this.resizable){if(dojo.isIE){this.canvas.style.overflow="auto";}else{this.containerNode.style.overflow="auto";}this._resizeHandle=new dojox.layout.ResizeHandle({targetId:this.id,resizeAxis:this.resizeAxis},this.resizeHandle);}if(this.dockable){var a=this.dockTo;if(this.dockTo){this.dockTo=dijit.byId(this.dockTo);}else{this.dockTo=dijit.byId("dojoxGlobalFloatingDock");}if(!this.dockTo){var c,b;if(a){c=a;b=dojo.byId(a);}else{b=dojo.create("div",null,dojo.body());dojo.addClass(b,"dojoxFloatingDockDefault");c="dojoxGlobalFloatingDock";}this.dockTo=new dojox.layout.Dock({id:c,autoPosition:"south"},b);this.dockTo.startup();}if((this.domNode.style.display=="none")||(this.domNode.style.visibility=="hidden")){this.minimize();}}this.connect(this.focusNode,"onmousedown","bringToTop");this.connect(this.domNode,"onmousedown","bringToTop");this.resize(dojo.coords(this.domNode));this._started=true;},setTitle:function(a){dojo.deprecated("pane.setTitle","Use pane.set('title', someTitle)","2.0");this.set("title",a);},close:function(){if(!this.closable){return;}dojo.unsubscribe(this._listener);this.hide(dojo.hitch(this,function(){this.destroyRecursive();}));},hide:function(a){dojo.fadeOut({node:this.domNode,duration:this.duration,onEnd:dojo.hitch(this,function(){this.domNode.style.display="none";this.domNode.style.visibility="hidden";if(this.dockTo&&this.dockable){this.dockTo._positionDock(null);}if(a){a();}})}).play();},show:function(b){var a=dojo.fadeIn({node:this.domNode,duration:this.duration,beforeBegin:dojo.hitch(this,function(){this.domNode.style.display="";this.domNode.style.visibility="visible";if(this.dockTo&&this.dockable){this.dockTo._positionDock(null);}if(typeof b=="function"){b();}this._isDocked=false;if(this._dockNode){this._dockNode.destroy();this._dockNode=null;}})}).play();this.resize(dojo.coords(this.domNode));this._onShow();},minimize:function(){if(!this._isDocked){this.hide(dojo.hitch(this,"_dock"));}},maximize:function(){if(this._maximized){return;}this._naturalState=dojo.position(this.domNode);if(this._isDocked){this.show();setTimeout(dojo.hitch(this,"maximize"),this.duration);}dojo.addClass(this.focusNode,"floatingPaneMaximized");this.resize(dojo.window.getBox());this._maximized=true;},_restore:function(){if(this._maximized){this.resize(this._naturalState);dojo.removeClass(this.focusNode,"floatingPaneMaximized");this._maximized=false;}},_dock:function(){if(!this._isDocked&&this.dockable){this._dockNode=this.dockTo.addNode(this);this._isDocked=true;}},resize:function(c){c=c||this._naturalState;this._currentState=c;this._naturalState=c;var a=this.domNode.style;if("t" in c){a.top=c.t+"px";}if("l" in c){a.left=c.l+"px";}a.width=c.w+"px";a.height=c.h+"px";var b={l:0,t:0,w:c.w,h:(c.h-this.focusNode.offsetHeight)};dojo.marginBox(this.canvas,b);this._checkIfSingleChild();if(this._singleChild&&this._singleChild.resize){this._singleChild.resize(b);}},bringToTop:function(){var a=dojo.filter(this._allFPs,function(b){return b!==this;},this);a.sort(function(d,c){return d.domNode.style.zIndex-c.domNode.style.zIndex;});a.push(this);dojo.forEach(a,function(c,b){c.domNode.style.zIndex=this._startZ+(b*2);dojo.removeClass(c.domNode,"dojoxFloatingPaneFg");},this);dojo.addClass(this.domNode,"dojoxFloatingPaneFg");},destroy:function(){this._allFPs.splice(dojo.indexOf(this._allFPs,this),1);if(this._resizeHandle){this._resizeHandle.destroy();}this.inherited(arguments);}});dojo.declare("dojox.layout.Dock",[dijit._Widget,dijit._Templated],{templateString:'<div class="dojoxDock"><ul dojoAttachPoint="containerNode" class="dojoxDockList"></ul></div>',_docked:[],_inPositioning:false,autoPosition:false,addNode:function(a){var c=dojo.create("li",null,this.containerNode),b=new dojox.layout._DockNode({title:a.title,paneRef:a},c);b.startup();return b;},startup:function(){if(this.id=="dojoxGlobalFloatingDock"||this.isFixedDock){this.connect(window,"onresize","_positionDock");this.connect(window,"onscroll","_positionDock");if(dojo.isIE){this.connect(this.domNode,"onresize","_positionDock");}}this._positionDock(null);this.inherited(arguments);},_positionDock:function(a){if(!this._inPositioning){if(this.autoPosition=="south"){setTimeout(dojo.hitch(this,function(){this._inPositiononing=true;var b=dojo.window.getBox();var c=this.domNode.style;c.left=b.l+"px";c.width=(b.w-2)+"px";c.top=(b.h+b.t)-this.domNode.offsetHeight+"px";this._inPositioning=false;}),125);}}}});dojo.declare("dojox.layout._DockNode",[dijit._Widget,dijit._Templated],{title:"",paneRef:null,templateString:'<li dojoAttachEvent="onclick: restore" class="dojoxDockNode"><span dojoAttachPoint="restoreNode" class="dojoxDockRestoreButton" dojoAttachEvent="onclick: restore"></span><span class="dojoxDockTitleNode" dojoAttachPoint="titleNode">${title}</span></li>',restore:function(){this.paneRef.show();this.paneRef.bringToTop();this.destroy();}});