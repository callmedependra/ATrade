define("dijit/_TimePicker",["dojo","dijit","text!dijit/templates/TimePicker.html","dijit/form/_FormWidget","dojo/date/locale"],function(a,b){a.declare("dijit._TimePicker",[b._Widget,b._Templated],{templateString:a.cache("dijit","templates/TimePicker.html"),baseClass:"dijitTimePicker",clickableIncrement:"T00:15:00",visibleIncrement:"T01:00:00",visibleRange:"T05:00:00",value:new Date(),_visibleIncrement:2,_clickableIncrement:1,_totalIncrements:10,constraints:{},serialize:a.date.stamp.toISOString,setValue:function(c){a.deprecated("dijit._TimePicker:setValue() is deprecated.  Use set('value', ...) instead.","","2.0");this.set("value",c);},_setValueAttr:function(c){this._set("value",c);this._showText();},_setFilterStringAttr:function(c){this._set("filterString",c);this._showText();},isDisabledDate:function(d,c){return false;},_getFilteredNodes:function(e,g,o,c){var d=[],p=c?c.date:this._refDate,f,k=e,m=this._maxIncrement+Math.abs(k),l=o?-1:1,j=o?1:0,h=1-j;do{k=k-j;f=this._createOption(k);if(f){if((o&&f.date>p)||(!o&&f.date<p)){break;}d[o?"unshift":"push"](f);p=f.date;}k=k+h;}while(d.length<g&&(k*l)<m);return d;},_showText:function(){var c=a.date.stamp.fromISOString;this.timeMenu.innerHTML="";this._clickableIncrementDate=c(this.clickableIncrement);this._visibleIncrementDate=c(this.visibleIncrement);this._visibleRangeDate=c(this.visibleRange);var f=function(k){return k.getHours()*60*60+k.getMinutes()*60+k.getSeconds();},e=f(this._clickableIncrementDate),j=f(this._visibleIncrementDate),d=f(this._visibleRangeDate),h=(this.value||this.currentFocus).getTime();this._refDate=new Date(h-h%(j*1000));this._refDate.setFullYear(1970,0,1);this._clickableIncrement=1;this._totalIncrements=d/e;this._visibleIncrement=j/e;this._maxIncrement=(60*60*24)/e;var i=this._getFilteredNodes(0,Math.min(this._totalIncrements>>1,10)-1),g=this._getFilteredNodes(0,Math.min(this._totalIncrements,10)-i.length,true,i[0]);a.forEach(g.concat(i),function(k){this.timeMenu.appendChild(k);},this);},constructor:function(){this.constraints={};},postMixInProperties:function(){this.inherited(arguments);this._setConstraintsAttr(this.constraints);},_setConstraintsAttr:function(c){a.mixin(this,c);if(!c.locale){c.locale=this.lang;}},postCreate:function(){this.connect(this.timeMenu,a.isIE?"onmousewheel":"DOMMouseScroll","_mouseWheeled");this._connects.push(b.typematic.addMouseListener(this.upArrow,this,"_onArrowUp",33,250));this._connects.push(b.typematic.addMouseListener(this.downArrow,this,"_onArrowDown",33,250));this.inherited(arguments);},_buttonMouse:function(c){a.toggleClass(c.currentTarget,c.currentTarget==this.upArrow?"dijitUpArrowHover":"dijitDownArrowHover",c.type=="mouseenter"||c.type=="mouseover");},_createOption:function(e){var d=new Date(this._refDate);var c=this._clickableIncrementDate;d.setHours(d.getHours()+c.getHours()*e,d.getMinutes()+c.getMinutes()*e,d.getSeconds()+c.getSeconds()*e);if(this.constraints.selector=="time"){d.setFullYear(1970,0,1);}var f=a.date.locale.format(d,this.constraints);if(this.filterString&&f.toLowerCase().indexOf(this.filterString)!==0){return null;}var g=a.create("div",{"class":this.baseClass+"Item"});g.date=d;g.index=e;a.create("div",{"class":this.baseClass+"ItemInner",innerHTML:f},g);if(e%this._visibleIncrement<1&&e%this._visibleIncrement>-1){a.addClass(g,this.baseClass+"Marker");}else{if(!(e%this._clickableIncrement)){a.addClass(g,this.baseClass+"Tick");}}if(this.isDisabledDate(d)){a.addClass(g,this.baseClass+"ItemDisabled");}if(this.value&&!a.date.compare(this.value,d,this.constraints.selector)){g.selected=true;a.addClass(g,this.baseClass+"ItemSelected");if(a.hasClass(g,this.baseClass+"Marker")){a.addClass(g,this.baseClass+"MarkerSelected");}else{a.addClass(g,this.baseClass+"TickSelected");}this._highlightOption(g,true);}return g;},_onOptionSelected:function(d){var c=d.target.date||d.target.parentNode.date;if(!c||this.isDisabledDate(c)){return;}this._highlighted_option=null;this.set("value",c);this.onChange(c);},onChange:function(c){},_highlightOption:function(d,c){if(!d){return;}if(c){if(this._highlighted_option){this._highlightOption(this._highlighted_option,false);}this._highlighted_option=d;}else{if(this._highlighted_option!==d){return;}else{this._highlighted_option=null;}}a.toggleClass(d,this.baseClass+"ItemHover",c);if(a.hasClass(d,this.baseClass+"Marker")){a.toggleClass(d,this.baseClass+"MarkerHover",c);}else{a.toggleClass(d,this.baseClass+"TickHover",c);}},onmouseover:function(d){this._keyboardSelected=null;var c=(d.target.parentNode===this.timeMenu)?d.target:d.target.parentNode;if(!a.hasClass(c,this.baseClass+"Item")){return;}this._highlightOption(c,true);},onmouseout:function(d){this._keyboardSelected=null;var c=(d.target.parentNode===this.timeMenu)?d.target:d.target.parentNode;this._highlightOption(c,false);},_mouseWheeled:function(c){this._keyboardSelected=null;a.stopEvent(c);var d=(a.isIE?c.wheelDelta:-c.detail);this[(d>0?"_onArrowUp":"_onArrowDown")]();},_onArrowUp:function(e){if(typeof e=="number"&&e==-1){return;}if(!this.timeMenu.childNodes.length){return;}var c=this.timeMenu.childNodes[0].index;var d=this._getFilteredNodes(c,1,true,this.timeMenu.childNodes[0]);if(d.length){this.timeMenu.removeChild(this.timeMenu.childNodes[this.timeMenu.childNodes.length-1]);this.timeMenu.insertBefore(d[0],this.timeMenu.childNodes[0]);}},_onArrowDown:function(e){if(typeof e=="number"&&e==-1){return;}if(!this.timeMenu.childNodes.length){return;}var c=this.timeMenu.childNodes[this.timeMenu.childNodes.length-1].index+1;var d=this._getFilteredNodes(c,1,false,this.timeMenu.childNodes[this.timeMenu.childNodes.length-1]);if(d.length){this.timeMenu.removeChild(this.timeMenu.childNodes[0]);this.timeMenu.appendChild(d[0]);}},handleKey:function(f){var d=a.keys;if(f.charOrCode==d.DOWN_ARROW||f.charOrCode==d.UP_ARROW){a.stopEvent(f);if(this._highlighted_option&&!this._highlighted_option.parentNode){this._highlighted_option=null;}var c=this.timeMenu,g=this._highlighted_option||a.query("."+this.baseClass+"ItemSelected",c)[0];if(!g){g=c.childNodes[0];}else{if(c.childNodes.length){if(f.charOrCode==d.DOWN_ARROW&&!g.nextSibling){this._onArrowDown();}else{if(f.charOrCode==d.UP_ARROW&&!g.previousSibling){this._onArrowUp();}}if(f.charOrCode==d.DOWN_ARROW){g=g.nextSibling;}else{g=g.previousSibling;}}}this._highlightOption(g,true);this._keyboardSelected=g;return false;}else{if(f.charOrCode==d.ENTER||f.charOrCode===d.TAB){if(!this._keyboardSelected&&f.charOrCode===d.TAB){return true;}if(this._highlighted_option){this._onOptionSelected({target:this._highlighted_option});}return f.charOrCode===d.TAB;}}}});return b._TimePicker;});