define("dojo/dnd/Mover",["dojo","dojo/dnd/common","dojo/dnd/autoscroll"],function(a){a.declare("dojo.dnd.Mover",null,{constructor:function(f,g,c){this.node=a.byId(f);var j=g.touches?g.touches[0]:g;this.marginBox={l:j.pageX,t:j.pageY};this.mouseButton=g.button;var b=(this.host=c),i=f.ownerDocument;this.events=[a.connect(i,"onmousemove",this,"onFirstMove"),a.connect(i,"ontouchmove",this,"onFirstMove"),a.connect(i,"onmousemove",this,"onMouseMove"),a.connect(i,"ontouchmove",this,"onMouseMove"),a.connect(i,"onmouseup",this,"onMouseUp"),a.connect(i,"ontouchend",this,"onMouseUp"),a.connect(i,"ondragstart",a.stopEvent),a.connect(i.body,"onselectstart",a.stopEvent)];if(b&&b.onMoveStart){b.onMoveStart(this);}},onMouseMove:function(c){var b=this.marginBox,d=c.touches?c.touches[0]:c;this.host.onMove(this,{l:b.l+d.pageX,t:b.t+d.pageY},c);a.stopEvent(c);},onMouseUp:function(b){if(a.isWebKit&&a.isMac&&this.mouseButton==2?b.button==0:this.mouseButton==b.button){this.destroy();}a.stopEvent(b);},onFirstMove:function(j){var p=this.node.style,f,o,g=this.host;switch(p.position){case"relative":case"absolute":f=Math.round(parseFloat(p.left))||0;o=Math.round(parseFloat(p.top))||0;break;default:p.position="absolute";var d=a.marginBox(this.node);var k=a.doc.body;var n=a.getComputedStyle(k);var c=a._getMarginBox(k,n);var i=a._getContentBox(k,n);f=d.l-(i.l-c.l);o=d.t-(i.t-c.t);break;}this.marginBox.l=f-this.marginBox.l;this.marginBox.t=o-this.marginBox.t;if(g&&g.onFirstMove){g.onFirstMove(this,j);}a.disconnect(this.events.shift());a.disconnect(this.events.shift());},destroy:function(){a.forEach(this.events,a.disconnect);var b=this.host;if(b&&b.onMoveStop){b.onMoveStop(this);}this.events=this.node=this.host=null;}});return a.dnd.Mover;});