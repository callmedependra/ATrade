define("dojo/dnd/Avatar",["dojo","dojo/dnd/common"],function(a){a.declare("dojo.dnd.Avatar",null,{constructor:function(b){this.manager=b;this.construct();},construct:function(){this.isA11y=a.hasClass(a.body(),"dijit_a11y");var n=a.create("table",{"class":"dojoDndAvatar",style:{position:"absolute",zIndex:"1999",margin:"0px"}}),c=this.manager.source,d,m=a.create("tbody",null,n),j=a.create("tr",null,m),e=a.create("td",null,j),l=this.isA11y?a.create("span",{id:"a11yIcon",innerHTML:this.manager.copy?"+":"<"},e):null,o=a.create("span",{innerHTML:c.generateText?this._generateText():""},e),f=Math.min(5,this.manager.nodes.length),h=0;a.attr(j,{"class":"dojoDndAvatarHeader",style:{opacity:0.9}});for(;h<f;++h){if(c.creator){d=c._normalizedCreator(c.getItem(this.manager.nodes[h].id).data,"avatar").node;}else{d=this.manager.nodes[h].cloneNode(true);if(d.tagName.toLowerCase()=="tr"){var p=a.create("table"),g=a.create("tbody",null,p);g.appendChild(d);d=p;}}d.id="";j=a.create("tr",null,m);e=a.create("td",null,j);e.appendChild(d);a.attr(j,{"class":"dojoDndAvatarItem",style:{opacity:(9-h)/10}});}this.node=n;},destroy:function(){a.destroy(this.node);this.node=false;},update:function(){a[(this.manager.canDropFlag?"add":"remove")+"Class"](this.node,"dojoDndAvatarCanDrop");if(this.isA11y){var b=a.byId("a11yIcon");var c="+";if(this.manager.canDropFlag&&!this.manager.copy){c="< ";}else{if(!this.manager.canDropFlag&&!this.manager.copy){c="o";}else{if(!this.manager.canDropFlag){c="x";}}}b.innerHTML=c;}a.query(("tr.dojoDndAvatarHeader td span"+(this.isA11y?" span":"")),this.node).forEach(function(d){d.innerHTML=this._generateText();},this);},_generateText:function(){return this.manager.nodes.length.toString();}});return a.dnd.Avatar;});