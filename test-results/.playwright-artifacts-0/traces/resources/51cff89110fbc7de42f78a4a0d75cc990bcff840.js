define("dijit/_HasDropDown",["dojo","dijit","dijit/_Widget"],function(a,b){a.declare("dijit._HasDropDown",null,{_buttonNode:null,_arrowWrapperNode:null,_popupStateNode:null,_aroundNode:null,dropDown:null,autoWidth:true,forceWidth:false,maxHeight:0,dropDownPosition:["below","above"],_stopClickEvents:true,_onDropDownMouseDown:function(c){if(this.disabled||this.readOnly){return;}a.stopEvent(c);this._docHandler=this.connect(a.doc,"onmouseup","_onDropDownMouseUp");this.toggleDropDown();},_onDropDownMouseUp:function(i){if(i&&this._docHandler){this.disconnect(this._docHandler);}var h=this.dropDown,d=false;if(i&&this._opened){var j=a.position(this._buttonNode,true);if(!(i.pageX>=j.x&&i.pageX<=j.x+j.w)||!(i.pageY>=j.y&&i.pageY<=j.y+j.h)){var f=i.target;while(f&&!d){if(a.hasClass(f,"dijitPopup")){d=true;}else{f=f.parentNode;}}if(d){f=i.target;if(h.onItemClick){var g;while(f&&!(g=b.byNode(f))){f=f.parentNode;}if(g&&g.onClick&&g.getParent){g.getParent().onItemClick(g,i);}}return;}}}if(this._opened&&h.focus&&h.autoFocus!==false){window.setTimeout(a.hitch(h,"focus"),1);}},_onDropDownClick:function(c){if(this._stopClickEvents){a.stopEvent(c);}},buildRendering:function(){this.inherited(arguments);this._buttonNode=this._buttonNode||this.focusNode||this.domNode;this._popupStateNode=this._popupStateNode||this.focusNode||this._buttonNode;var c={after:this.isLeftToRight()?"Right":"Left",before:this.isLeftToRight()?"Left":"Right",above:"Up",below:"Down",left:"Left",right:"Right"}[this.dropDownPosition[0]]||this.dropDownPosition[0]||"Down";a.addClass(this._arrowWrapperNode||this._buttonNode,"dijit"+c+"ArrowButton");},postCreate:function(){this.inherited(arguments);this.connect(this._buttonNode,"onmousedown","_onDropDownMouseDown");this.connect(this._buttonNode,"onclick","_onDropDownClick");this.connect(this.focusNode,"onkeypress","_onKey");this.connect(this.focusNode,"onkeyup","_onKeyUp");},destroy:function(){if(this.dropDown){if(!this.dropDown._destroyed){this.dropDown.destroyRecursive();}delete this.dropDown;}this.inherited(arguments);},_onKey:function(f){if(this.disabled||this.readOnly){return;}var g=this.dropDown,c=f.target;if(g&&this._opened&&g.handleKey){if(g.handleKey(f)===false){a.stopEvent(f);return;}}if(g&&this._opened&&f.charOrCode==a.keys.ESCAPE){this.closeDropDown();a.stopEvent(f);}else{if(!this._opened&&(f.charOrCode==a.keys.DOWN_ARROW||((f.charOrCode==a.keys.ENTER||f.charOrCode==" ")&&((c.tagName||"").toLowerCase()!=="input"||(c.type&&c.type.toLowerCase()!=="text"))))){this._toggleOnKeyUp=true;a.stopEvent(f);}}},_onKeyUp:function(){if(this._toggleOnKeyUp){delete this._toggleOnKeyUp;this.toggleDropDown();var c=this.dropDown;if(c&&c.focus){setTimeout(a.hitch(c,"focus"),1);}}},_onBlur:function(){var c=b._curFocus&&this.dropDown&&a.isDescendant(b._curFocus,this.dropDown.domNode);this.closeDropDown(c);this.inherited(arguments);},isLoaded:function(){return true;},loadDropDown:function(c){c();},toggleDropDown:function(){if(this.disabled||this.readOnly){return;}if(!this._opened){if(!this.isLoaded()){this.loadDropDown(a.hitch(this,"openDropDown"));return;}else{this.openDropDown();}}else{this.closeDropDown();}},openDropDown:function(){var e=this.dropDown,i=e.domNode,g=this._aroundNode||this.domNode,m=this;if(!this._preparedNode){this._preparedNode=true;if(i.style.width){this._explicitDDWidth=true;}if(i.style.height){this._explicitDDHeight=true;}}if(this.maxHeight||this.forceWidth||this.autoWidth){var c={display:"",visibility:"hidden"};if(!this._explicitDDWidth){c.width="";}if(!this._explicitDDHeight){c.height="";}a.style(i,c);var l=this.maxHeight;if(l==-1){var j=a.window.getBox(),h=a.position(g,false);l=Math.floor(Math.max(h.y,j.h-(h.y+h.h)));}if(e.startup&&!e._started){e.startup();}b.popup.moveOffScreen(e);var k=a._getMarginSize(i);var f=(l&&k.h>l);a.style(i,{overflowX:"hidden",overflowY:f?"auto":"hidden"});if(f){k.h=l;if("w" in k){k.w+=16;}}else{delete k.h;}if(this.forceWidth){k.w=g.offsetWidth;}else{if(this.autoWidth){k.w=Math.max(k.w,g.offsetWidth);}else{delete k.w;}}if(a.isFunction(e.resize)){e.resize(k);}else{a.marginBox(i,k);}}var d=b.popup.open({parent:this,popup:e,around:g,orient:b.getPopupAroundAlignment((this.dropDownPosition&&this.dropDownPosition.length)?this.dropDownPosition:["below"],this.isLeftToRight()),onExecute:function(){m.closeDropDown(true);},onCancel:function(){m.closeDropDown(true);},onClose:function(){a.attr(m._popupStateNode,"popupActive",false);a.removeClass(m._popupStateNode,"dijitHasDropDownOpen");m._opened=false;}});a.attr(this._popupStateNode,"popupActive","true");a.addClass(m._popupStateNode,"dijitHasDropDownOpen");this._opened=true;return d;},closeDropDown:function(c){if(this._opened){if(c){this.focus();}b.popup.close(this.dropDown);this._opened=false;}}});return b._HasDropDown;});