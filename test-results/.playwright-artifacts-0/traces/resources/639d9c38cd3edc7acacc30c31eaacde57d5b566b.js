define("dojo/_base/connect",["dojo/lib/kernel","dojo/_base/lang"],function(a){a._listener={getDispatcher:function(){return function(){var f=Array.prototype,j=arguments.callee,b=j._listeners,e=j.target,g=e&&e.apply(this,arguments),d,h=[].concat(b);for(d in h){if(!(d in f)){h[d].apply(this,arguments);}}return g;};},add:function(e,h,c){e=e||a.global;var b=e[h];if(!b||!b._listeners){var g=a._listener.getDispatcher();g.target=b;g._listeners=[];b=e[h]=g;}return b._listeners.push(c);},remove:function(d,e,c){var b=(d||a.global)[e];if(b&&b._listeners&&c--){delete b._listeners[c];}}};a.connect=function(g,c,e,b,m){var k=arguments,j=[],h=0;j.push(a.isString(k[0])?null:k[h++],k[h++]);var d=k[h+1];j.push(a.isString(d)||a.isFunction(d)?k[h++]:null,k[h++]);for(var f=k.length;h<f;h++){j.push(k[h]);}return a._connect.apply(this,j);};a._connect=function(f,e,c,g){var b=a._listener,d=b.add(f,e,a.hitch(c,g));return[f,e,d,b];};a.disconnect=function(b){if(b&&b[0]!==undefined){a._disconnect.apply(this,b);delete b[0];}};a._disconnect=function(e,b,d,c){c.remove(e,b,d);};a._topics={};a.subscribe=function(b,c,d){return[b,a._listener.add(a._topics,b,a.hitch(c,d))];};a.unsubscribe=function(b){if(b){a._listener.remove(a._topics,b[0],b[1]);}};a.publish=function(c,b){var d=a._topics[c];if(d){d.apply(this,b||[]);}};a.connectPublisher=function(c,e,d){var b=function(){a.publish(c,arguments);};return d?a.connect(e,d,b):a.connect(e,b);};return a.connect;});