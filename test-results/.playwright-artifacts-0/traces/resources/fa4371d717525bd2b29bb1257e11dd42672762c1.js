define("dijit/Calendar",["dojo","dijit","text!dijit/templates/Calendar.html","dojo/cldr/supplemental","dojo/date","dojo/date/locale","dijit/_Widget","dijit/_Templated","dijit/_CssStateMixin","dijit/form/DropDownButton"],function(a,b){a.declare("dijit.Calendar",[b._Widget,b._Templated,b._CssStateMixin],{templateString:a.cache("dijit","templates/Calendar.html"),widgetsInTemplate:true,value:new Date(""),datePackage:"dojo.date",dayWidth:"narrow",tabIndex:"0",currentFocus:new Date(),baseClass:"dijitCalendar",cssStateNodes:{decrementMonth:"dijitCalendarArrow",incrementMonth:"dijitCalendarArrow",previousYearLabelNode:"dijitCalendarPreviousYear",nextYearLabelNode:"dijitCalendarNextYear"},_isValidDate:function(c){return c&&!isNaN(c)&&typeof c=="object"&&c.toString()!=this.constructor.prototype.value.toString();},setValue:function(c){a.deprecated("dijit.Calendar:setValue() is deprecated.  Use set('value', ...) instead.","","2.0");this.set("value",c);},_getValueAttr:function(){var c=new this.dateClassObj(this.value);c.setHours(0,0,0,0);if(c.getDate()<this.value.getDate()){c=this.dateFuncObj.add(c,"hour",1);}return c;},_setValueAttr:function(d,c){if(d){d=new this.dateClassObj(d);}if(this._isValidDate(d)){if(!this._isValidDate(this.value)||this.dateFuncObj.compare(d,this.value)){d.setHours(1,0,0,0);if(!this.isDisabledDate(d,this.lang)){this._set("value",d);this.set("currentFocus",d);if(c||typeof c=="undefined"){this.onChange(this.get("value"));this.onValueSelected(this.get("value"));}}}}else{this._set("value",null);this.set("currentFocus",this.currentFocus);}},_setText:function(c,d){while(c.firstChild){c.removeChild(c.firstChild);}c.appendChild(a.doc.createTextNode(d));},_populateGrid:function(){var g=new this.dateClassObj(this.currentFocus);g.setDate(1);var c=g.getDay(),e=this.dateFuncObj.getDaysInMonth(g),k=this.dateFuncObj.getDaysInMonth(this.dateFuncObj.add(g,"month",-1)),i=new this.dateClassObj(),l=a.cldr.supplemental.getFirstDayOfWeek(this.lang);if(l>c){l-=7;}a.query(".dijitCalendarDateTemplate",this.domNode).forEach(function(s,n){n+=l;var d=new this.dateClassObj(g),m,o="dijitCalendar",q=0;if(n<c){m=k-c+n+1;q=-1;o+="Previous";}else{if(n>=(c+e)){m=n-c-e+1;q=1;o+="Next";}else{m=n-c+1;o+="Current";}}if(q){d=this.dateFuncObj.add(d,"month",q);}d.setDate(m);if(!this.dateFuncObj.compare(d,i,"date")){o="dijitCalendarCurrentDate "+o;}if(this._isSelectedDate(d,this.lang)){o="dijitCalendarSelectedDate "+o;}if(this.isDisabledDate(d,this.lang)){o="dijitCalendarDisabledDate "+o;}var p=this.getClassForDate(d,this.lang);if(p){o=p+" "+o;}s.className=o+"Month dijitCalendarDateTemplate";s.dijitDateValue=d.valueOf();a.attr(s,"dijitDateValue",d.valueOf());var r=a.query(".dijitCalendarDateLabel",s)[0],t=d.getDateLocalized?d.getDateLocalized(this.lang):d.getDate();this._setText(r,t);},this);var f=this.dateLocaleModule.getNames("months","wide","standAlone",this.lang,g);this.monthDropDownButton.dropDown.set("months",f);this.monthDropDownButton.containerNode.innerHTML=(a.isIE==6?"":"<div class='dijitSpacer'>"+this.monthDropDownButton.dropDown.domNode.innerHTML+"</div>")+"<div class='dijitCalendarMonthLabel dijitCalendarCurrentMonthLabel'>"+f[g.getMonth()]+"</div>";var j=g.getFullYear()-1;var h=new this.dateClassObj();a.forEach(["previous","current","next"],function(d){h.setFullYear(j++);this._setText(this[d+"YearLabelNode"],this.dateLocaleModule.format(h,{selector:"year",locale:this.lang}));},this);},goToToday:function(){this.set("value",new this.dateClassObj());},constructor:function(c){var d=(c.datePackage&&(c.datePackage!="dojo.date"))?c.datePackage+".Date":"Date";this.dateClassObj=a.getObject(d,false);this.datePackage=c.datePackage||this.datePackage;this.dateFuncObj=a.getObject(this.datePackage,false);this.dateLocaleModule=a.getObject(this.datePackage+".locale",false);},postMixInProperties:function(){if(isNaN(this.value)){delete this.value;}this.inherited(arguments);},buildRendering:function(){this.inherited(arguments);a.setSelectable(this.domNode,false);var e=a.hitch(this,function(j,m){var l=a.query(j,this.domNode)[0];for(var k=0;k<m;k++){l.parentNode.appendChild(l.cloneNode(true));}});e(".dijitCalendarDayLabelTemplate",6);e(".dijitCalendarDateTemplate",6);e(".dijitCalendarWeekTemplate",5);var h=this.dateLocaleModule.getNames("days",this.dayWidth,"standAlone",this.lang);var d=a.cldr.supplemental.getFirstDayOfWeek(this.lang);a.query(".dijitCalendarDayLabel",this.domNode).forEach(function(j,k){this._setText(j,h[(k+d)%7]);},this);var c=new this.dateClassObj(this.currentFocus);this.monthDropDownButton.dropDown=new b.Calendar._MonthDropDown({id:this.id+"_mdd",onChange:a.hitch(this,"_onMonthSelect")});this.set("currentFocus",c,false);var g=this;var f=function(j,k,i){g._connects.push(b.typematic.addMouseListener(g[j],g,function(l){if(l>=0){g._adjustDisplay(k,i);}},0.8,500));};f("incrementMonth","month",1);f("decrementMonth","month",-1);f("nextYearLabelNode","year",1);f("previousYearLabelNode","year",-1);},_adjustDisplay:function(c,d){this._setCurrentFocusAttr(this.dateFuncObj.add(this.currentFocus,c,d));},_setCurrentFocusAttr:function(d,g){var e=this.currentFocus,c=e?a.query("[dijitDateValue="+e.valueOf()+"]",this.domNode)[0]:null;d=new this.dateClassObj(d);d.setHours(1,0,0,0);this._set("currentFocus",d);this._populateGrid();var f=a.query("[dijitDateValue="+d.valueOf()+"]",this.domNode)[0];f.setAttribute("tabIndex",this.tabIndex);if(this._focused||g){f.focus();}if(c&&c!=f){if(a.isWebKit){c.setAttribute("tabIndex","-1");}else{c.removeAttribute("tabIndex");}}},focus:function(){this._setCurrentFocusAttr(this.currentFocus,true);},_onMonthSelect:function(c){this.currentFocus=this.dateFuncObj.add(this.currentFocus,"month",c-this.currentFocus.getMonth());this._populateGrid();},_onDayClick:function(c){a.stopEvent(c);for(var d=c.target;d&&!d.dijitDateValue;d=d.parentNode){}if(d&&!a.hasClass(d,"dijitCalendarDisabledDate")){this.set("value",d.dijitDateValue);}},_onDayMouseOver:function(c){var d=a.hasClass(c.target,"dijitCalendarDateLabel")?c.target.parentNode:c.target;if(d&&(d.dijitDateValue||d==this.previousYearLabelNode||d==this.nextYearLabelNode)){a.addClass(d,"dijitCalendarHoveredDate");this._currentNode=d;}},_onDayMouseOut:function(d){if(!this._currentNode){return;}if(d.relatedTarget&&d.relatedTarget.parentNode==this._currentNode){return;}var c="dijitCalendarHoveredDate";if(a.hasClass(this._currentNode,"dijitCalendarActiveDate")){c+=" dijitCalendarActiveDate";}a.removeClass(this._currentNode,c);this._currentNode=null;},_onDayMouseDown:function(c){var d=c.target.parentNode;if(d&&d.dijitDateValue){a.addClass(d,"dijitCalendarActiveDate");this._currentNode=d;}},_onDayMouseUp:function(c){var d=c.target.parentNode;if(d&&d.dijitDateValue){a.removeClass(d,"dijitCalendarActiveDate");}},handleKey:function(d){var f=a.keys,c=-1,e,g=this.currentFocus;switch(d.keyCode){case f.RIGHT_ARROW:c=1;case f.LEFT_ARROW:e="day";if(!this.isLeftToRight()){c*=-1;}break;case f.DOWN_ARROW:c=1;case f.UP_ARROW:e="week";break;case f.PAGE_DOWN:c=1;case f.PAGE_UP:e=d.ctrlKey||d.altKey?"year":"month";break;case f.END:g=this.dateFuncObj.add(g,"month",1);e="day";case f.HOME:g=new this.dateClassObj(g);g.setDate(1);break;case f.ENTER:case f.SPACE:this.set("value",this.currentFocus);break;default:return true;}if(e){g=this.dateFuncObj.add(g,e,c);}this._setCurrentFocusAttr(g);return false;},_onKeyPress:function(c){if(!this.handleKey(c)){a.stopEvent(c);}},onValueSelected:function(c){},onChange:function(c){},_isSelectedDate:function(d,c){return this._isValidDate(this.value)&&!this.dateFuncObj.compare(d,this.value,"date");},isDisabledDate:function(d,c){},getClassForDate:function(d,c){}});a.declare("dijit.Calendar._MonthDropDown",[b._Widget,b._Templated],{months:[],templateString:"<div class='dijitCalendarMonthMenu dijitMenu' dojoAttachEvent='onclick:_onClick,onmouseover:_onMenuHover,onmouseout:_onMenuHover'></div>",_setMonthsAttr:function(c){this.domNode.innerHTML=a.map(c,function(e,d){return e?"<div class='dijitCalendarMonthLabel' month='"+d+"'>"+e+"</div>":"";}).join("");},_onClick:function(c){this.onChange(a.attr(c.target,"month"));},onChange:function(c){},_onMenuHover:function(c){a.toggleClass(c.target,"dijitCalendarMonthLabelHover",c.type=="mouseover");}});return b.Calendar;});