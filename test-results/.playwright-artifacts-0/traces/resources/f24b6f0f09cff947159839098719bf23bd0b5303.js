define("dijit/layout/ScrollingTabController",["dojo","dijit","text!dijit/layout/templates/ScrollingTabController.html","text!dijit/layout/templates/_ScrollingTabControllerButton.html","dijit/layout/TabController","dijit/Menu","dijit/form/Button","dijit/_HasDropDown"],function(a,b){a.declare("dijit.layout.ScrollingTabController",b.layout.TabController,{templateString:a.cache("dijit.layout","templates/ScrollingTabController.html"),useMenu:true,useSlider:true,tabStripClass:"",widgetsInTemplate:true,_minScroll:5,attributeMap:a.delegate(b._Widget.prototype.attributeMap,{"class":"containerNode"}),buildRendering:function(){this.inherited(arguments);var c=this.domNode;this.scrollNode=this.tablistWrapper;this._initButtons();if(!this.tabStripClass){this.tabStripClass="dijitTabContainer"+this.tabPosition.charAt(0).toUpperCase()+this.tabPosition.substr(1).replace(/-.*/,"")+"None";a.addClass(c,"tabStrip-disabled");}a.addClass(this.tablistWrapper,this.tabStripClass);},onStartup:function(){this.inherited(arguments);a.style(this.domNode,"visibility","visible");this._postStartup=true;},onAddChild:function(d,c){this.inherited(arguments);a.forEach(["label","iconClass"],function(e){this.pane2watches[d.id].push(this.pane2button[d.id].watch(e,a.hitch(this,function(g,f,h){if(this._postStartup&&this._dim){this.resize(this._dim);}})));},this);a.style(this.containerNode,"width",(a.style(this.containerNode,"width")+200)+"px");},onRemoveChild:function(e,c){var d=this.pane2button[e.id];if(this._selectedTab===d.domNode){this._selectedTab=null;}this.inherited(arguments);},_initButtons:function(){this._btnWidth=0;this._buttons=a.query("> .tabStripButton",this.domNode).filter(function(c){if((this.useMenu&&c==this._menuBtn.domNode)||(this.useSlider&&(c==this._rightBtn.domNode||c==this._leftBtn.domNode))){this._btnWidth+=a._getMarginSize(c).w;return true;}else{a.style(c,"display","none");return false;}},this);},_getTabsWidth:function(){var d=this.getChildren();if(d.length){var e=d[this.isLeftToRight()?0:d.length-1].domNode,c=d[this.isLeftToRight()?d.length-1:0].domNode;return c.offsetLeft+a.style(c,"width")-e.offsetLeft;}else{return 0;}},_enableBtn:function(d){var c=this._getTabsWidth();d=d||a.style(this.scrollNode,"width");return c>0&&d<c;},resize:function(f){if(this.domNode.offsetWidth==0){return;}this._dim=f;this.scrollNode.style.height="auto";this._contentBox=b.layout.marginBox2contentBox(this.domNode,{h:0,w:f.w});this._contentBox.h=this.scrollNode.offsetHeight;a.contentBox(this.domNode,this._contentBox);var e=this._enableBtn(this._contentBox.w);this._buttons.style("display",e?"":"none");this._leftBtn.layoutAlign="left";this._rightBtn.layoutAlign="right";this._menuBtn.layoutAlign=this.isLeftToRight()?"right":"left";b.layout.layoutChildren(this.domNode,this._contentBox,[this._menuBtn,this._leftBtn,this._rightBtn,{domNode:this.scrollNode,layoutAlign:"client"}]);if(this._selectedTab){if(this._anim&&this._anim.status()=="playing"){this._anim.stop();}var d=this.scrollNode,c=this._convertToScrollLeft(this._getScrollForSelectedTab());d.scrollLeft=c;}this._setButtonClass(this._getScroll());this._postResize=true;return{h:this._contentBox.h,w:f.w};},_getScroll:function(){var c=(this.isLeftToRight()||a.isIE<8||(a.isIE&&a.isQuirks)||a.isWebKit)?this.scrollNode.scrollLeft:a.style(this.containerNode,"width")-a.style(this.scrollNode,"width")+(a.isIE==8?-1:1)*this.scrollNode.scrollLeft;return c;},_convertToScrollLeft:function(d){if(this.isLeftToRight()||a.isIE<8||(a.isIE&&a.isQuirks)||a.isWebKit){return d;}else{var c=a.style(this.containerNode,"width")-a.style(this.scrollNode,"width");return(a.isIE==8?-1:1)*(d-c);}},onSelectChild:function(f){var d=this.pane2button[f.id];if(!d||!f){return;}var e=d.domNode;if(this._postResize&&e!=this._selectedTab){this._selectedTab=e;var c=this._getScroll();if(c>e.offsetLeft||c+a.style(this.scrollNode,"width")<e.offsetLeft+a.style(e,"width")){this.createSmoothScroll().play();}}this.inherited(arguments);},_getScrollBounds:function(){var e=this.getChildren(),d=a.style(this.scrollNode,"width"),g=a.style(this.containerNode,"width"),h=g-d,f=this._getTabsWidth();if(e.length&&f>d){return{min:this.isLeftToRight()?0:e[e.length-1].domNode.offsetLeft,max:this.isLeftToRight()?(e[e.length-1].domNode.offsetLeft+a.style(e[e.length-1].domNode,"width"))-d:h};}else{var c=this.isLeftToRight()?0:h;return{min:c,max:c};}},_getScrollForSelectedTab:function(){var d=this.scrollNode,g=this._selectedTab,e=a.style(this.scrollNode,"width"),c=this._getScrollBounds();var f=(g.offsetLeft+a.style(g,"width")/2)-e/2;f=Math.min(Math.max(f,c.min),c.max);return f;},createSmoothScroll:function(d){if(arguments.length>0){var c=this._getScrollBounds();d=Math.min(Math.max(d,c.min),c.max);}else{d=this._getScrollForSelectedTab();}if(this._anim&&this._anim.status()=="playing"){this._anim.stop();}var f=this,e=this.scrollNode,g=new a._Animation({beforeBegin:function(){if(this.curve){delete this.curve;}var h=e.scrollLeft,i=f._convertToScrollLeft(d);g.curve=new a._Line(h,i);},onAnimate:function(h){e.scrollLeft=h;}});this._anim=g;this._setButtonClass(d);return g;},_getBtnNode:function(c){var d=c.target;while(d&&!a.hasClass(d,"tabStripButton")){d=d.parentNode;}return d;},doSlideRight:function(c){this.doSlide(1,this._getBtnNode(c));},doSlideLeft:function(c){this.doSlide(-1,this._getBtnNode(c));},doSlide:function(f,c){if(c&&a.hasClass(c,"dijitTabDisabled")){return;}var e=a.style(this.scrollNode,"width");var g=(e*0.75)*f;var h=this._getScroll()+g;this._setButtonClass(h);this.createSmoothScroll(h).play();},_setButtonClass:function(d){var c=this._getScrollBounds();this._leftBtn.set("disabled",d<=c.min);this._rightBtn.set("disabled",d>=c.max);}});a.declare("dijit.layout._ScrollingTabControllerButtonMixin",null,{baseClass:"dijitTab tabStripButton",templateString:a.cache("dijit.layout","templates/_ScrollingTabControllerButton.html"),tabIndex:"",isFocusable:function(){return false;}});a.declare("dijit.layout._ScrollingTabControllerButton",[b.form.Button,b.layout._ScrollingTabControllerButtonMixin]);a.declare("dijit.layout._ScrollingTabControllerMenuButton",[b.form.Button,b._HasDropDown,b.layout._ScrollingTabControllerButtonMixin],{containerId:"",tabIndex:"-1",isLoaded:function(){return false;},loadDropDown:function(d){this.dropDown=new b.Menu({id:this.containerId+"_menu",dir:this.dir,lang:this.lang});var c=b.byId(this.containerId);a.forEach(c.getChildren(),function(f){var e=new b.MenuItem({id:f.id+"_stcMi",label:f.title,iconClass:f.iconClass,dir:f.dir,lang:f.lang,onClick:function(){c.selectChild(f);}});this.dropDown.addChild(e);},this);d();},closeDropDown:function(c){this.inherited(arguments);if(this.dropDown){this.dropDown.destroyRecursive();delete this.dropDown;}}});return b.layout.ScrollingTabController;});