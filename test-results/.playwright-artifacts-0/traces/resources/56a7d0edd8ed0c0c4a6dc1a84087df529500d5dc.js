define("dojo/_base/Deferred",["dojo/lib/kernel","dojo/_base/lang"],function(a){(function(){var c=function(){};var b=Object.freeze||function(){};a.Deferred=function(k){var m,e,g,h,f;var l=(this.promise={});function d(n){if(e){throw new Error("This deferred has already been resolved");}m=n;e=true;i();}function i(){var o;while(!o&&f){var q=f;f=f.next;if((o=(q.progress==c))){e=false;}var p=(g?q.error:q.resolved);if(p){try{var n=p(m);if(n&&typeof n.then==="function"){n.then(a.hitch(q.deferred,"resolve"),a.hitch(q.deferred,"reject"));continue;}var s=o&&n===undefined;if(o&&!s){g=n instanceof Error;}q.deferred[s&&g?"reject":"resolve"](s?m:n);}catch(r){q.deferred.reject(r);}}else{if(g){q.deferred.reject(m);}else{q.deferred.resolve(m);}}}}this.resolve=this.callback=function(n){this.fired=0;this.results=[n,null];d(n);};this.reject=this.errback=function(n){g=true;this.fired=1;d(n);this.results=[null,n];if(!n||n.log!==false){(a.config.deferredOnError||function(o){console.error(o);})(n);}};this.progress=function(p){var o=f;while(o){var n=o.progress;n&&n(p);o=o.next;}};this.addCallbacks=function(o,n){this.then(o,n,c);return this;};this.then=l.then=function(n,o,r){var p=r==c?this:new a.Deferred(l.cancel);var q={resolved:n,error:o,progress:r,deferred:p};if(f){h=h.next=q;}else{f=h=q;}if(e){i();}return p.promise;};var j=this;this.cancel=l.cancel=function(){if(!e){var n=k&&k(j);if(!e){if(!(n instanceof Error)){n=new Error(n);}n.log=false;j.reject(n);}}};b(l);};a.extend(a.Deferred,{addCallback:function(d){return this.addCallbacks(a.hitch.apply(a,arguments));},addErrback:function(d){return this.addCallbacks(null,a.hitch.apply(a,arguments));},addBoth:function(e){var d=a.hitch.apply(a,arguments);return this.addCallbacks(d,d);},fired:-1});})();a.when=function(c,e,d,b){if(c&&typeof c.then==="function"){return c.then(e,d,b);}return e(c);};return a.Deferred;});